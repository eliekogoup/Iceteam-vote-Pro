(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[335],{1972:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>o});var t=r(7876),n=r(4232),i=r(9099),c=r(4613),u=r(3610);function o(){let e=(0,i.useRouter)(),[s,r]=(0,n.useState)([]),[o,a]=(0,n.useState)(!0),[l,d]=(0,n.useState)(""),[p,m]=(0,n.useState)(null);async function h(){a(!0);let{data:e,error:s}=await c.N.from("questions").select("*").order("id");!s&&e&&r(e),a(!1)}async function f(e){e.preventDefault(),p?await c.N.from("questions").update({text:l}).eq("id",p):await c.N.from("questions").insert({text:l}),d(""),m(null),h()}async function x(e){let r=s.find(s=>s.id===e);if(!r)return void alert("Question introuvable");if(confirm('Supprimer la question "'.concat(r.text.substring(0,50),'..." ?'))){let s=await (0,u.UJ)(e);s.success?(alert("✅ ".concat(s.message)),h()):alert("❌ ".concat(s.message))}}return(0,n.useEffect)(()=>{h()},[]),(0,t.jsxs)("div",{style:{padding:32},children:[(0,t.jsx)("button",{onClick:()=>e.push("/admin"),children:"← Retour \xe0 l'administration"}),(0,t.jsx)("h2",{children:"Gestion des Questions"}),(0,t.jsxs)("form",{onSubmit:f,style:{marginBottom:20},children:[(0,t.jsx)("input",{type:"text",placeholder:"Texte de la question",value:l,onChange:e=>d(e.target.value),required:!0}),(0,t.jsx)("button",{type:"submit",children:p?"Modifier":"Ajouter"}),p&&(0,t.jsx)("button",{type:"button",onClick:()=>{m(null),d("")},children:"Annuler"})]}),o?(0,t.jsx)("p",{children:"Chargement..."}):(0,t.jsxs)("table",{children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"ID"}),(0,t.jsx)("th",{children:"Texte"}),(0,t.jsx)("th",{children:"Actions"})]})}),(0,t.jsx)("tbody",{children:s.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e.id}),(0,t.jsx)("td",{children:e.text}),(0,t.jsxs)("td",{children:[(0,t.jsx)("button",{onClick:()=>{m(e.id),d(e.text)},children:"Editer"}),(0,t.jsx)("button",{onClick:()=>x(e.id),style:{color:"red"},children:"Supprimer"})]})]},e.id))})]})]})}},3092:(e,s,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/questions",function(){return r(1972)}])},3610:(e,s,r)=>{"use strict";r.d(s,{EG:()=>n,Ke:()=>u,UJ:()=>c,cq:()=>i});var t=r(4613);async function n(e){try{let{data:s,error:r}=await t.N.rpc("delete_member_safely",{member_id_to_delete:e});if(r)return console.error("Erreur suppression membre:",r),{success:!1,message:"Erreur lors de la suppression: ".concat(r.message)};return{success:!0,message:s||"Membre supprim\xe9 avec succ\xe8s"}}catch(e){return console.error("Erreur inattendue:",e),{success:!1,message:"Erreur inattendue lors de la suppression"}}}async function i(e){try{let{data:s,error:r}=await t.N.rpc("delete_edition_safely",{edition_id_to_delete:e});if(r)return console.error("Erreur suppression \xe9dition:",r),{success:!1,message:"Erreur lors de la suppression: ".concat(r.message)};return{success:!0,message:s||"\xc9dition supprim\xe9e avec succ\xe8s"}}catch(e){return console.error("Erreur inattendue:",e),{success:!1,message:"Erreur inattendue lors de la suppression"}}}async function c(e){try{let{data:s,error:r}=await t.N.rpc("delete_question_safely",{question_id_to_delete:e});if(r)return console.error("Erreur suppression question:",r),{success:!1,message:"Erreur lors de la suppression: ".concat(r.message)};return{success:!0,message:s||"Question supprim\xe9e avec succ\xe8s"}}catch(e){return console.error("Erreur inattendue:",e),{success:!1,message:"Erreur inattendue lors de la suppression"}}}async function u(e,s,r,t,n,i,c){let u,o=r(e),a=t(e);if(u="\xcates-vous s\xfbr de vouloir supprimer ".concat(s,' "').concat(o,'" ?'),c&&c.length>0&&(u+="\n\n⚠️ ATTENTION:\n"+c.join("\n")),confirm(u+="\n\nCette action est irr\xe9versible."))try{let e=await n(a);e.success?alert("✅ ".concat(e.message)):alert("❌ ".concat(e.message)),e.success&&i&&i()}catch(e){console.error("Erreur lors de la suppression:",e),alert("❌ Erreur inattendue lors de la suppression")}}},4613:(e,s,r)=>{"use strict";r.d(s,{N:()=>t});let t=(0,r(166).UU)("https://gllqzajfkkvpwnyultiy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdsbHF6YWpma2t2cHdueXVsdGl5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwODczNjcsImV4cCI6MjA3NDY2MzM2N30.B5gXCuB2XCpT11W6unXPhFC2WX-2TsPsJA7PA32qK8E")},9099:(e,s,r)=>{e.exports=r(6296)}},e=>{e.O(0,[166,636,593,792],()=>e(e.s=3092)),_N_E=e.O()}]);